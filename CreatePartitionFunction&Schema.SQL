SET NOCOUNT ON

DECLARE @CNT INT = 30

declare @PF_CMD_PRE VARCHAR(MAX) = 'CREATE PARTITION FUNCTION [PF_DATETIME] (DATETIME) AS RANGE RIGHT FOR VALUES ('
declare @PS_CMD_PRE VARCHAR(MAX) = 'CREATE PARTITION SCHEME [PS_DATETIME] AS PARTITION [PF_DATETIME] TO ([BMSDB_COMPARE_DATA],'
declare @PF_CMD_WORK VARCHAR(MAX) = ''
declare @PS_CMD_WORK VARCHAR(MAX) = ''
DECLARE @BEING_DATE DATETIME = '2014-03-15'
DECLARE @END_DATE DATETIME = '2014-03-20'
DECLARE @TMP_DATE DATETIME = @BEING_DATE
DECLARE @FG_NO INT
DECLARE @FG_NAME VARCHAR(100) =  'BMSDB_COMPARE_DATA'


WHILE @TMP_DATE < @END_DATE
BEGIN

 SET @FG_NO = DAY(@TMP_DATE)


SET @PF_CMD_WORK = @PF_CMD_WORK +''''+CONVERT(VARCHAR(10),@TMP_DATE,111)+''','
SET @PS_CMD_WORK = @PS_CMD_WORK + '['+@FG_NAME+'],'


set @TMP_DATE=@TMP_DATE+1
END

SET @PF_CMD_WORK =  LEFT(@PF_CMD_WORK ,LEN( @PF_CMD_WORK )-1)
SET @PS_CMD_WORK =  LEFT(@PS_CMD_WORK ,LEN( @PS_CMD_WORK )-1)




PRINT @PF_CMD_PRE+@PF_CMD_WORK+')'
SELECT @PS_CMD_PRE+@PS_CMD_WORK+')'
